
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>startup</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-10-24"><meta name="DC.source" content="startup.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">asympPDC Package startup script</a></li><li><a href="#2">Set package version</a></li><li><a href="#3">Set path</a></li><li><a href="#4">Check if Octave</a></li><li><a href="#5">Check for dependencies on other MATLAB&reg; toolboxes and fileexchange routines</a></li><li><a href="#6">needed in asympPDC</a></li><li><a href="#7">Initialize default random number stream</a></li><li><a href="#8">Enable all warnings</a></li></ul></div><h2 id="1">asympPDC Package startup script</h2><p>Run this file to initialize the set up of asympPDC Package.</p><p>You may have to customize this script for your computing environment.</p><pre class="codeinput"><span class="comment">% (C) Koichi Sameshima &amp; Luiz A. Baccal&aacute;, 2022.</span>
<span class="comment">% See file license.txt in installation directory for licensing terms.</span>
</pre><h2 id="2">Set package version</h2><pre class="codeinput"><span class="keyword">global</span> asymppdc_version;
asymppdc_version.major = 3;
asymppdc_version.minor = 0;

clc
fprintf(<span class="string">'                   Initializing asympPDC Package version %d.%d\n'</span>, <span class="keyword">...</span>
   asymppdc_version.major, asymppdc_version.minor);
fprintf(<span class="string">'                   ==========================================\n'</span>);
fprintf(1,<span class="string">'\n'</span>)
</pre><h2 id="3">Set path</h2><pre class="codeinput"><span class="comment">% Add asympPDC root directory and appropriate subdirectories to matlabpath</span>

<span class="keyword">global</span> asymppdc_root;
<span class="comment">%asymppdc_root = fileparts(mfilename('fullpath')); % directory containing this file</span>
asymppdc_root = [pwd <span class="string">'/'</span>];
<span class="comment">% essentials</span>

addpath(asymppdc_root);
addpath(fullfile(asymppdc_root,<span class="string">'core'</span>));
addpath(fullfile(asymppdc_root,<span class="string">'extras'</span>));
addpath(fullfile(asymppdc_root,<span class="string">'utils'</span>));
addpath(fullfile(asymppdc_root,<span class="string">'utils'</span>,<span class="string">'arfit'</span>));
addpath(fullfile(asymppdc_root,<span class="string">'utils'</span>,<span class="string">'legacy'</span>));
addpath(fullfile(asymppdc_root,<span class="string">'examples'</span>));
addpath(fullfile(asymppdc_root,<span class="string">'examples'</span>,<span class="string">'models'</span>));

fprintf(<span class="string">'[asympPDC startup] Added asymppdc root directory, \n'</span>)
fprintf(<span class="string">'                      %s, \n'</span>,asymppdc_root);
<span class="keyword">if</span> isOctave()
   warning(<span class="string">'off'</span>, <span class="string">'all'</span>);
   fprintf(<span class="string">'                   and its subdirectories to the OCTAVE search path.\n'</span>)
<span class="keyword">else</span>
   fprintf(<span class="string">'                   and its subdirectories to the MATLAB search path.\n'</span>)
<span class="keyword">end</span>
fprintf(1,<span class="string">'\n'</span>)
</pre><h2 id="4">Check if Octave</h2><pre class="codeinput"><span class="keyword">if</span> isOctave()
   fprintf(<span class="string">'[asympPDC startup] As this is an Octave environment, checking whether control,\n'</span>)
   fprintf(<span class="string">'                   statistics and signal packages are loaded or not.\n'</span>)
   fprintf(1,<span class="string">'\n'</span>)
   installed_packages = pkg(<span class="string">'list'</span>);
   [dummy, N] = size(installed_packages);
   <span class="keyword">if</span> N ~= 0
      kPkgs = 0;
      pkglist = {<span class="string">'signal'</span>, <span class="string">'statistics'</span>, <span class="string">'control'</span>};  <span class="comment">% List of necessary Octave</span>
      <span class="comment">% packages.</span>
      <span class="keyword">for</span> k = 1:N
         <span class="keyword">for</span> klist = 1:3
            pkgstr = pkglist{klist};
            <span class="keyword">if</span> strcmpi(installed_packages{k}.name,pkgstr)
               fprintf(<span class="string">'                   Package %s is installed and loaded.\n'</span>,pkgstr)
               kPkgs = kPkgs + 1;
            <span class="keyword">end</span>
         <span class="keyword">end</span>
      <span class="keyword">end</span>
      fprintf(1,<span class="string">'\n'</span>)

      <span class="keyword">if</span> kPkgs &lt; 3
         fprintf(2,<span class="string">'[asympPDC startup] Warning: some of required packages were not installed or loaded.\n'</span>)
         fprintf(2,<span class="string">'                   The required packages are statistics, signal and control. \n'</span>)
         fprintf(2,<span class="string">'                   If the package is already installed, load them into Octave \n'</span>)
         fprintf(2,<span class="string">'                   environment before proceeding by executing: \n'</span>)
         fprintf(2,<span class="string">'                          &gt;&gt; pkg load &lt;package-name&gt;\n'</span>)
         fprintf(1,<span class="string">'\n'</span>)
         fprintf(2,<span class="string">'                   If not installed, run \n'</span>)
         fprintf(2,<span class="string">'                          &gt;&gt; pkg install -forge io\n'</span>)
         fprintf(2,<span class="string">'                          &gt;&gt; pkg install -forge &lt;package-name&gt;\n'</span>)
         fprintf(1,<span class="string">'\n'</span>)
         fprintf(2,<span class="string">'                   See Octave documentation for loading packages on start up \n'</span>)
         fprintf(2,<span class="string">'                   editing ".octaverc" file. \n'</span>)
      <span class="keyword">else</span>
         fprintf(<span class="string">'[asympPDC startup] All necessary packages are already loaded into Octave environment!\n'</span>)
         fprintf(<span class="string">'                   You are good to go.\n'</span>)

      <span class="keyword">end</span>
   <span class="keyword">else</span>
      fprintf(2,<span class="string">'[asympPDC startup] Warning: the control, statistics and signal packages are not load in Octave environment.\n'</span>)
      fprintf(2,<span class="string">'                   If packages are already installed, load them into Octave environment before proceeding with analysis\n'</span>)
      fprintf(2,<span class="string">'                   through: \n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg load signal\n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg load control\n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg load statistics\n'</span>)
      fprintf(2,<span class="string">'                   otherwise install them by executing \n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg install -forge io\n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg install -forge control\n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg install -forge signal\n'</span>)
      fprintf(2,<span class="string">'                          &gt;&gt; pkg install -forge statistics\n'</span>)
      fprintf(2,<span class="string">'                   then execute "pkg load &lt;package-name&gt; commands. \n'</span>)
      fprintf(2,<span class="string">'                   See Octave documentation for loading packages on start up editing ".octaverc" file. \n'</span>)
   <span class="keyword">end</span>
   fprintf(2,<span class="string">'                   If you see any error message concerning availability of package,\n'</span>)
   fprintf(2,<span class="string">'                   please take proper action to correct it before continuing.\n'</span>)
fprintf(1,<span class="string">'\n'</span>)
<span class="keyword">end</span>
</pre><h2 id="5">Check for dependencies on other MATLAB&reg; toolboxes and fileexchange routines</h2><h2 id="6">needed in asympPDC</h2><pre class="codeinput"><span class="comment">% Check if Statistics Toolbox is available - see if ch2cdf is present</span>
<span class="keyword">if</span> ~isOctave()
   kPkgs = 0;
   <span class="keyword">if</span> ~isempty(which(<span class="string">'chi2cdf'</span>)) &amp;&amp; ~isempty(which(<span class="string">'chi2inv'</span>)) <span class="keyword">...</span>
         &amp;&amp; ~isempty(which(<span class="string">'norminv'</span>))
      fprintf(<span class="string">'[asympPDC startup] Statistics Toolbox(TM) or Statistics and Machine Learning Toolbox(TM) \n'</span>);
      fprintf(<span class="string">'                   seems to be present.\n'</span>);
      kPkgs = kPkgs +1;
   <span class="keyword">else</span>
      fprintf(2,<span class="string">'[asympPDC startup] WARNING: Statistics Toolbox(TM) or Statistics and Machine \n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          Learning Toolbox(TM) does not seem to be present.\n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          Will not be able to perform asymptotic statistical \n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          tests for PDC and DTF estimates. \n'</span>)
   <span class="keyword">end</span>
   fprintf(1,<span class="string">'\n'</span>)

   <span class="comment">% Check if we have Signal Processing toolbox - see if pwelch is present</span>

   <span class="keyword">if</span> ~isempty(which(<span class="string">'xcorr'</span>)) &amp;&amp; ~isempty(which(<span class="string">'norminv'</span>))
      fprintf(<span class="string">'[asympPDC startup] Signal Processing Toolbox(TM) seems to be present.\n'</span>);
      kPkgs = kPkgs +1;
   <span class="keyword">else</span>
      fprintf(2,<span class="string">'[asympPDC startup] WARNING: Signal Processing Toolbox(TM) does not seem to be present.\n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          Will not be able to perform mvarresidue routines \n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          for the residues test for whiteness. \n'</span>)
   <span class="keyword">end</span>
   fprintf(1,<span class="string">'\n'</span>)
<span class="keyword">end</span>

<span class="keyword">if</span> ~isempty(which(<span class="string">'dlyap'</span>)) &amp;&amp; ~isOctave()
   fprintf(<span class="string">'[asympPDC startup] Control System Toolbox(TM) seems to be present.\n'</span>);
   kPkgs = kPkgs +1;
<span class="keyword">else</span>
   fprintf(2,<span class="string">'[asympPDC startup] WARNING: Control System Toolbox(TM) does not seem to be present.\n\n'</span>);
   fprintf(  <span class="string">'[asympPDC startup] The lyap.m legacy code from 1986 Control System Toolbox(TM) will be used.\n'</span>);
   addpath(fullfile(asymppdc_root,<span class="string">'utils'</span>,<span class="string">'legacy'</span>));
   fprintf(  <span class="string">'[asympPDC startup] Adding ./code/utils/legacy directory to MATLAB path with lyap.m.\n'</span>);
<span class="keyword">end</span>

<span class="keyword">if</span> ~isempty(which(<span class="string">'lyap'</span>))
   <span class="comment">% Testing lyap.m code using Example 1 from modern lyap help.</span>
   <span class="comment">%The A matrix is stable, and the Q matrix is positive definite.</span>

   <span class="comment">% Define an absolute tolerance</span>
   tol = 1e-10;
   <span class="comment">% Three input arguments example</span>
   A = 5;
   B = [4 3; 4 3];
   C = [2 1];
   X = lyap(A,B,C);
   <span class="comment">% If correct, these commands should return the following X matrix:</span>
   Xcorrect = [   -0.2000   -0.0500];

   <span class="keyword">if</span> sum(abs(Xcorrect(:) - X(:))) &lt;= tol
      fprintf(<span class="string">'                   The *lyap* function is present and working properly.\n'</span>);
   <span class="keyword">else</span>
      error(<span class="string">'Problem with lyap.m function. Verify lyap.m function.'</span>)
   <span class="keyword">end</span>
   clear <span class="string">A</span> <span class="string">B</span> <span class="string">C</span> <span class="string">X</span> <span class="string">Q</span> <span class="string">Xcorrect</span> <span class="string">tol</span>
<span class="keyword">else</span>
   fprintf(2,<span class="string">'[asympPDC startup] WARNING: Control System Toolbox(TM) not installed,\n'</span>);
   fprintf(2,<span class="string">'[asympPDC startup]          and lyap function is not available.\n'</span>);
<span class="keyword">end</span>
fprintf(1,<span class="string">'\n'</span>)

<span class="comment">% Check if we have ARFit package is present</span>

<span class="keyword">if</span> ~isempty(which(<span class="string">'arfit'</span>)) &amp;&amp; ~isempty(which(<span class="string">'arfitcaps'</span>))
   fprintf(<span class="string">'[asympPDC startup] ARFit Toolbox(TM) seems to be present.\n'</span>);
<span class="keyword">else</span>
   fprintf(2,<span class="string">'[asympPDC startup] WARNING: ARFit(TM) does not seem to be present.\n'</span>);
   fprintf(2,<span class="string">'[asympPDC startup]          Will not be able to perform asymptotic statistics \n'</span>);
   fprintf(2,<span class="string">'[asympPDC startup]          analyses for both PDC and DTF. \n'</span>)
<span class="keyword">end</span>
fprintf(1,<span class="string">'\n'</span>)


<span class="keyword">if</span> ~isempty(which(<span class="string">'suplabel'</span>)) &amp;&amp; ~isempty(which(<span class="string">'suptitle'</span>))
   <span class="keyword">if</span> isOctave()
      fprintf(<span class="string">'[asympPDC startup] The xplot function will use suptitle.m (Drea Thomas, 1995).\n\n'</span>);
      fprintf(<span class="string">'               (*) As suplabel.m (Ben Barrowes, 2004) does not work in Octave,\n'</span>);
      fprintf(<span class="string">'                   the y- and x-axis labels will be missing in the matrix layout subplots, .\n'</span>);

   <span class="keyword">else</span>
      fprintf(<span class="string">'[asympPDC startup] The xplot function will use suplabel.m (Ben Barrowes, 2004), and\n'</span>);
      fprintf(<span class="string">'                                               suptitle.m (Drea Thomas, 1995).\n'</span>);
   <span class="keyword">end</span>
   fprintf(1,<span class="string">'\n'</span>)
<span class="keyword">if</span> ~isempty(which(<span class="string">'shadedplot'</span>)) &amp;&amp; ~isempty(which(<span class="string">'boundedline'</span>))
   fprintf(<span class="string">'                   And, also, if required,  shadedplot.m (Dave Van Tol, 2008), and\n'</span>);
   fprintf(<span class="string">'                                            boundedline.m (Kelly Kearney, 2012).\n'</span>);
   fprintf(1,<span class="string">'\n'</span>)
<span class="keyword">end</span>
<span class="keyword">end</span>

<span class="keyword">if</span> ~isOctave()
   <span class="keyword">if</span> ~isempty(which(<span class="string">'tilefigs'</span>)) || ~isempty(which(<span class="string">'tilefigs1'</span>)) || ~isempty(which(<span class="string">'tilefigs2'</span>))
      fprintf(<span class="string">'[asympPDC startup] You may quickly visualize multiple figure windows issuing either\n'</span>);
      fprintf(<span class="string">'                   tilefigs1 (Peter J Acklam,2003) or tilefigs2 (Brendan Tracey, 2012) command.\n'</span>);
   <span class="keyword">end</span>
<span class="keyword">end</span>
fprintf(1,<span class="string">'\n'</span>)
</pre><h2 id="7">Initialize default random number stream</h2><p>Initialize rng to avoid predictability of sessions</p><pre class="codeinput"><span class="keyword">if</span> isOctave()
   randn(<span class="string">'seed'</span>,sum(100*clock)); <span class="comment">% set randn initial 'seed' randomization.</span>
   fprintf(<span class="string">'[asympPDC startup] Random number generator uses ad hoc initialization for Octave.\n'</span>);

<span class="keyword">else</span>
   rng(<span class="string">'default'</span>)
   rng(<span class="string">'shuffle'</span>)
   fprintf(<span class="string">'[asympPDC startup] Random number generator initialized using MATLAB recommended procedure.\n'</span>);
<span class="keyword">end</span>
fprintf(1,<span class="string">'\n'</span>)
</pre><h2 id="8">Enable all warnings</h2><pre class="codeinput"><span class="keyword">if</span> isOctave()
   warning(<span class="string">'off'</span>, <span class="string">'all'</span>);
<span class="keyword">else</span>
   warning <span class="string">on</span> <span class="string">all</span>
<span class="keyword">end</span>

<span class="keyword">if</span> kPkgs &lt; 3
   <span class="keyword">if</span> isOctave()
      fprintf(1,<span class="string">'\n'</span>)
      fprintf(2,<span class="string">'[asympPDC startup] WARNING: One or more required Octave package(s) are missing.\n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          Install the packages before proceeding. \n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          (You may re-run ''startup.m'').\n\n\n'</span>)
   <span class="keyword">else</span>
      fprintf(1,<span class="string">'\n'</span>)
      fprintf(2,<span class="string">'[asympPDC startup] WARNING: One or more required MATLAB toolboxes are missing.\n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          Statistics, Control Systen and Signal Processing Toolboxes \n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          are necessary for running asympPDC Package. \n'</span>);
      fprintf(2,<span class="string">'[asympPDC startup]          (You may re-run ''startup.m'').\n\n\n'</span>)

   <span class="keyword">end</span>
<span class="keyword">else</span>
   fprintf(<span class="string">'[asympPDC startup] All warnings enabled\n'</span>);
   fprintf(1,<span class="string">'\n'</span>)
   fprintf(<span class="string">'[asympPDC startup] Initialization completed (you may re-run ''startup.m'' if necessary).\n\n\n'</span>);
<span class="keyword">end</span>
<span class="comment">% &lt;startup.html back to top&gt;</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% asympPDC Package startup script
%
% Run this file to initialize the set up of asympPDC Package.
%
% You may have to customize this script for your computing environment.
%

% (C) Koichi Sameshima & Luiz A. Baccalá, 2022. 
% See file license.txt in installation directory for licensing terms.


%% Set package version

global asymppdc_version;
asymppdc_version.major = 3;
asymppdc_version.minor = 0;

clc
fprintf('                   Initializing asympPDC Package version %d.%d\n', ...
   asymppdc_version.major, asymppdc_version.minor);
fprintf('                   ==========================================\n');
fprintf(1,'\n')
%% Set path

% Add asympPDC root directory and appropriate subdirectories to matlabpath

global asymppdc_root;
%asymppdc_root = fileparts(mfilename('fullpath')); % directory containing this file
asymppdc_root = [pwd '/'];
% essentials

addpath(asymppdc_root);
addpath(fullfile(asymppdc_root,'core'));
addpath(fullfile(asymppdc_root,'extras'));
addpath(fullfile(asymppdc_root,'utils'));
addpath(fullfile(asymppdc_root,'utils','arfit'));
addpath(fullfile(asymppdc_root,'utils','legacy'));
addpath(fullfile(asymppdc_root,'examples'));
addpath(fullfile(asymppdc_root,'examples','models'));

fprintf('[asympPDC startup] Added asymppdc root directory, \n')
fprintf('                      %s, \n',asymppdc_root);
if isOctave()
   warning('off', 'all');
   fprintf('                   and its subdirectories to the OCTAVE search path.\n')
else
   fprintf('                   and its subdirectories to the MATLAB search path.\n')
end
fprintf(1,'\n')
%% Check if Octave
%
if isOctave()
   fprintf('[asympPDC startup] As this is an Octave environment, checking whether control,\n')
   fprintf('                   statistics and signal packages are loaded or not.\n')
   fprintf(1,'\n')
   installed_packages = pkg('list');
   [dummy, N] = size(installed_packages);
   if N ~= 0
      kPkgs = 0;
      pkglist = {'signal', 'statistics', 'control'};  % List of necessary Octave
      % packages.
      for k = 1:N
         for klist = 1:3
            pkgstr = pkglist{klist};
            if strcmpi(installed_packages{k}.name,pkgstr)
               fprintf('                   Package %s is installed and loaded.\n',pkgstr)
               kPkgs = kPkgs + 1;
            end
         end
      end
      fprintf(1,'\n')

      if kPkgs < 3
         fprintf(2,'[asympPDC startup] Warning: some of required packages were not installed or loaded.\n')
         fprintf(2,'                   The required packages are statistics, signal and control. \n')
         fprintf(2,'                   If the package is already installed, load them into Octave \n')
         fprintf(2,'                   environment before proceeding by executing: \n')
         fprintf(2,'                          >> pkg load <package-name>\n')
         fprintf(1,'\n')
         fprintf(2,'                   If not installed, run \n')
         fprintf(2,'                          >> pkg install -forge io\n')
         fprintf(2,'                          >> pkg install -forge <package-name>\n')
         fprintf(1,'\n')
         fprintf(2,'                   See Octave documentation for loading packages on start up \n')
         fprintf(2,'                   editing ".octaverc" file. \n')
      else
         fprintf('[asympPDC startup] All necessary packages are already loaded into Octave environment!\n')
         fprintf('                   You are good to go.\n')

      end
   else
      fprintf(2,'[asympPDC startup] Warning: the control, statistics and signal packages are not load in Octave environment.\n')
      fprintf(2,'                   If packages are already installed, load them into Octave environment before proceeding with analysis\n')
      fprintf(2,'                   through: \n')
      fprintf(2,'                          >> pkg load signal\n')
      fprintf(2,'                          >> pkg load control\n')
      fprintf(2,'                          >> pkg load statistics\n')
      fprintf(2,'                   otherwise install them by executing \n')
      fprintf(2,'                          >> pkg install -forge io\n')
      fprintf(2,'                          >> pkg install -forge control\n')
      fprintf(2,'                          >> pkg install -forge signal\n')
      fprintf(2,'                          >> pkg install -forge statistics\n')
      fprintf(2,'                   then execute "pkg load <package-name> commands. \n')
      fprintf(2,'                   See Octave documentation for loading packages on start up editing ".octaverc" file. \n')
   end
   fprintf(2,'                   If you see any error message concerning availability of package,\n')
   fprintf(2,'                   please take proper action to correct it before continuing.\n')
fprintf(1,'\n')
end

%% Check for dependencies on other MATLAB(R) toolboxes and fileexchange routines
%% needed in asympPDC

% Check if Statistics Toolbox is available - see if ch2cdf is present
if ~isOctave()
   kPkgs = 0;
   if ~isempty(which('chi2cdf')) && ~isempty(which('chi2inv')) ...
         && ~isempty(which('norminv'))
      fprintf('[asympPDC startup] Statistics Toolbox(TM) or Statistics and Machine Learning Toolbox(TM) \n');
      fprintf('                   seems to be present.\n');
      kPkgs = kPkgs +1;
   else
      fprintf(2,'[asympPDC startup] WARNING: Statistics Toolbox(TM) or Statistics and Machine \n');
      fprintf(2,'[asympPDC startup]          Learning Toolbox(TM) does not seem to be present.\n');
      fprintf(2,'[asympPDC startup]          Will not be able to perform asymptotic statistical \n');
      fprintf(2,'[asympPDC startup]          tests for PDC and DTF estimates. \n')
   end
   fprintf(1,'\n')

   % Check if we have Signal Processing toolbox - see if pwelch is present

   if ~isempty(which('xcorr')) && ~isempty(which('norminv'))
      fprintf('[asympPDC startup] Signal Processing Toolbox(TM) seems to be present.\n');
      kPkgs = kPkgs +1;
   else
      fprintf(2,'[asympPDC startup] WARNING: Signal Processing Toolbox(TM) does not seem to be present.\n');
      fprintf(2,'[asympPDC startup]          Will not be able to perform mvarresidue routines \n');
      fprintf(2,'[asympPDC startup]          for the residues test for whiteness. \n')
   end
   fprintf(1,'\n')
end

if ~isempty(which('dlyap')) && ~isOctave()
   fprintf('[asympPDC startup] Control System Toolbox(TM) seems to be present.\n');
   kPkgs = kPkgs +1;
else
   fprintf(2,'[asympPDC startup] WARNING: Control System Toolbox(TM) does not seem to be present.\n\n');
   fprintf(  '[asympPDC startup] The lyap.m legacy code from 1986 Control System Toolbox(TM) will be used.\n');
   addpath(fullfile(asymppdc_root,'utils','legacy'));
   fprintf(  '[asympPDC startup] Adding ./code/utils/legacy directory to MATLAB path with lyap.m.\n');
end

if ~isempty(which('lyap'))
   % Testing lyap.m code using Example 1 from modern lyap help.
   %The A matrix is stable, and the Q matrix is positive definite.

   % Define an absolute tolerance
   tol = 1e-10;
   % Three input arguments example
   A = 5;
   B = [4 3; 4 3];
   C = [2 1];
   X = lyap(A,B,C);
   % If correct, these commands should return the following X matrix:
   Xcorrect = [   -0.2000   -0.0500];

   if sum(abs(Xcorrect(:) - X(:))) <= tol
      fprintf('                   The *lyap* function is present and working properly.\n');
   else
      error('Problem with lyap.m function. Verify lyap.m function.')
   end
   clear A B C X Q Xcorrect tol
else
   fprintf(2,'[asympPDC startup] WARNING: Control System Toolbox(TM) not installed,\n');
   fprintf(2,'[asympPDC startup]          and lyap function is not available.\n');
end
fprintf(1,'\n')

% Check if we have ARFit package is present

if ~isempty(which('arfit')) && ~isempty(which('arfitcaps'))
   fprintf('[asympPDC startup] ARFit Toolbox(TM) seems to be present.\n');
else
   fprintf(2,'[asympPDC startup] WARNING: ARFit(TM) does not seem to be present.\n');
   fprintf(2,'[asympPDC startup]          Will not be able to perform asymptotic statistics \n');
   fprintf(2,'[asympPDC startup]          analyses for both PDC and DTF. \n')
end
fprintf(1,'\n')


if ~isempty(which('suplabel')) && ~isempty(which('suptitle'))
   if isOctave()
      fprintf('[asympPDC startup] The xplot function will use suptitle.m (Drea Thomas, 1995).\n\n');
      fprintf('               (*) As suplabel.m (Ben Barrowes, 2004) does not work in Octave,\n');
      fprintf('                   the y- and x-axis labels will be missing in the matrix layout subplots, .\n');

   else
      fprintf('[asympPDC startup] The xplot function will use suplabel.m (Ben Barrowes, 2004), and\n');
      fprintf('                                               suptitle.m (Drea Thomas, 1995).\n');
   end
   fprintf(1,'\n')
if ~isempty(which('shadedplot')) && ~isempty(which('boundedline'))
   fprintf('                   And, also, if required,  shadedplot.m (Dave Van Tol, 2008), and\n');
   fprintf('                                            boundedline.m (Kelly Kearney, 2012).\n');
   fprintf(1,'\n')
end
end

if ~isOctave()
   if ~isempty(which('tilefigs')) || ~isempty(which('tilefigs1')) || ~isempty(which('tilefigs2'))
      fprintf('[asympPDC startup] You may quickly visualize multiple figure windows issuing either\n');
      fprintf('                   tilefigs1 (Peter J Acklam,2003) or tilefigs2 (Brendan Tracey, 2012) command.\n');
   end
end
fprintf(1,'\n')

%% Initialize default random number stream
% Initialize rng to avoid predictability of sessions
if isOctave()
   randn('seed',sum(100*clock)); % set randn initial 'seed' randomization.
   fprintf('[asympPDC startup] Random number generator uses ad hoc initialization for Octave.\n');

else
   rng('default')
   rng('shuffle')
   fprintf('[asympPDC startup] Random number generator initialized using MATLAB recommended procedure.\n');
end
fprintf(1,'\n')

%% Enable all warnings

if isOctave()
   warning('off', 'all');
else
   warning on all
end

if kPkgs < 3
   if isOctave()
      fprintf(1,'\n')
      fprintf(2,'[asympPDC startup] WARNING: One or more required Octave package(s) are missing.\n');
      fprintf(2,'[asympPDC startup]          Install the packages before proceeding. \n');
      fprintf(2,'[asympPDC startup]          (You may re-run ''startup.m'').\n\n\n')
   else
      fprintf(1,'\n')
      fprintf(2,'[asympPDC startup] WARNING: One or more required MATLAB toolboxes are missing.\n');
      fprintf(2,'[asympPDC startup]          Statistics, Control Systen and Signal Processing Toolboxes \n');
      fprintf(2,'[asympPDC startup]          are necessary for running asympPDC Package. \n');
      fprintf(2,'[asympPDC startup]          (You may re-run ''startup.m'').\n\n\n')
      
   end
else
   fprintf('[asympPDC startup] All warnings enabled\n');
   fprintf(1,'\n')
   fprintf('[asympPDC startup] Initialization completed (you may re-run ''startup.m'' if necessary).\n\n\n');
end
% <startup.html back to top>


##### SOURCE END #####
--></body></html>
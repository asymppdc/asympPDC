
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Baccala &amp; Sameshima (2001b) 7-dimension VAR[2] model with loop and feedback</title><meta name="generator" content="MATLAB 9.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-06-03"><meta name="DC.source" content="milano_ipdc_presentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Baccala &amp; Sameshima (2001b) 7-dimension VAR[2] model with loop and feedback</h1><!--introduction--><p>Description:</p><p>Baccala &amp; Sameshima. Overcoming the limitations of correlation analysis for many simultaneously processed neural structures, Progress in Brain Research, 130:33--47, 2001.</p><p><a href="http://dx.doi.org/10.1016/S0079-6123(01)30004-3">http://dx.doi.org/10.1016/S0079-6123(01)30004-3</a></p><p>See also:</p><div><ol><li>Koichi Sameshima, Daniel Y. Takahashi, Luiz A. Baccala. On the statistical performance of Granger-causal connectivity estimators. Brain Informatics (2015) 2:119?133.</li></ol></div><p><a href="http://dx.doi.org/10.1007/s40708-015-0015-1">http://dx.doi.org/10.1007/s40708-015-0015-1</a></p><p>Example Model 1 - 7-dimension VAR[2] model with loop and feedback</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Data sample generation</a></li><li><a href="#2">Model Interaction diagram, model equation and expected results</a></li><li><a href="#3">Equation Model I with feedback</a></li><li><a href="#4">iDTF and iPDC expected results</a></li><li><a href="#5">Data pre-processing: detrending and standardization options</a></li><li><a href="#9">Information PDC estimation</a></li><li><a href="#12">iDTF estimation</a></li></ul></div><h2 id="1">Data sample generation</h2><pre class="codeinput">clear; clc; format <span class="string">compact</span>; format <span class="string">short</span>

nDiscard = 50000;          <span class="comment">% discarded points at beginning of simulation</span>
nSegLength  = 5000;        <span class="comment">% number of analyzed samples points</span>
N = nDiscard + nSegLength; <span class="comment">% number of simulated points</span>

u = fbaccala2001b_model1_feedback_milano( nSegLength, nDiscard );

[nSegLength,nChannels]=size(u);

<span class="comment">%chLabels = []; % or</span>
chLabels = {<span class="string">'x_1'</span>;<span class="string">'x_2'</span>;<span class="string">'x_3'</span>;<span class="string">'x_4'</span>;<span class="string">'x_5'</span>;<span class="string">'x_6'</span>;<span class="string">'x_7'</span>};

fs = 1;
</pre><pre class="codeoutput">======================================================================
                       Linear VAR[2] Model I
        Baccala &amp; Sameshima. Prog Brain Research, 130:33--47, 2001.
  x1--&gt;x2  x1--&gt;x3  x2--&gt;x3 x3--&gt;x4 x4==&gt;x5 x5--&gt;x1  x5--&gt;x4 x6==&gt;x7
======================================================================
</pre><h2 id="2">Model Interaction diagram, model equation and expected results</h2><p><img vspace="5" hspace="5" src="fig_baccala2001b_graph.png" alt=""> </p><p>Figure 2a from Baccala &amp; Sameshima. <i>Biol. Cybern.</i> <b>84</b>:463-474, 2001.</p><h2 id="3">Equation Model I with feedback</h2><p><img vspace="5" hspace="5" src="fig_baccala2001b_eq.png" alt=""> </p><h2 id="4">iDTF and iPDC expected results</h2><p><img vspace="5" hspace="5" src="fig_sameshima2005_fig2_iDTFiPDCresults.png" alt=""> </p><h2 id="5">Data pre-processing: detrending and standardization options</h2><pre class="codeinput">flgDetrend = 1;     <span class="comment">% Detrending the data set</span>
flgStandardize = 0; <span class="comment">% No standardization</span>
[nChannels,nSegLength] =size(u);
<span class="keyword">if</span> nChannels &gt; nSegLength,
   u = u.';
   [nChannels,nSegLength]=size(u);
<span class="keyword">end</span>;
<span class="keyword">if</span> flgDetrend,
   <span class="keyword">for</span> i=1:nChannels, u(i,:)=detrend(u(i,:)); <span class="keyword">end</span>;
   disp(<span class="string">'Time series were detrended.'</span>);
<span class="keyword">end</span>;
<span class="keyword">if</span> flgStandardize,
   <span class="keyword">for</span> i=1:nChannels, u(i,:)=u(i,:)/std(u(i,:)); <span class="keyword">end</span>;
   disp(<span class="string">'Time series were scale-standardized.'</span>);
<span class="keyword">end</span>;
</pre><pre class="codeoutput">Time series were detrended.
</pre><p>MVAR model estimation</p><pre class="codeinput">alpha = 0.01;

maxIP = 30;         <span class="comment">% maximum model order to consider.</span>
alg = 1;            <span class="comment">% 1: Nutall-Strand MVAR estimation algorithm</span>
criterion = 1;      <span class="comment">% 1: AIC, Akaike Information Criteria</span>

fprintf(<span class="string">'\n'</span>)
disp(<span class="string">'Running MVAR estimation routine.'</span>)

[IP,pf,A,pb,B,ef,eb,vaic,Vaicv] = mvar(u,maxIP,alg,criterion);

disp([<span class="string">'Number of channels = '</span> int2str(nChannels) <span class="string">' with '</span> <span class="keyword">...</span>
    int2str(nSegLength) <span class="string">' data points; MAR model order = '</span> int2str(IP) <span class="string">'.'</span>]);
   fprintf(<span class="string">'\n'</span>)
</pre><pre class="codeoutput">
Running MVAR estimation routine.
maxOrder limited to 30
IP=1  vaic=314088.471329
IP=2  vaic=297929.469754
IP=3  vaic=297974.108862
 
Number of channels = 7 with 5000 data points; MAR model order = 2.

</pre><p>Testing for adequacy of MAR model fitting through Portmanteau test</p><pre class="codeinput">h = 20; <span class="comment">% testing lag</span>
MVARadequacy_signif = 0.05; <span class="comment">% VAR model estimation adequacy significance</span>
                            <span class="comment">% level</span>
aValueMVAR = 1 - MVARadequacy_signif; <span class="comment">% Confidence value for the testing</span>

flgPrintResults = 1;

[Pass,Portmanteau,st,ths] = mvarresidue(ef,nSegLength,IP,aValueMVAR,h,<span class="keyword">...</span>
                                           flgPrintResults);
</pre><pre class="codeoutput">----------------------------------------------------------------------
                  MVAR Residues test for whiteness
======================================================================
Good MAR model fitting! Residues white noise hypothesis NOT rejected.
Pass = 0.0438776
  st = 940.579
</pre><p>Granger causality test (GCT) and instantaneous GCT (iGCT)</p><pre class="codeinput">gct_signif  = alpha;  <span class="comment">% Granger causality test significance level</span>
igct_signif = alpha;  <span class="comment">% Instantaneous GCT significance level</span>

metric = <span class="string">'info'</span>; <span class="comment">% euc  = original PDC or DTF;</span>
                 <span class="comment">% diag = generalized PDC (gPDC) or DC;</span>
                 <span class="comment">% info = information PDC (iPDC) or iDTF.</span>
flgPrintResults = 1;

[Tr_gct, pValue_gct] = gct_alg2(u,A,pf,gct_signif,flgPrintResults);
[Tr_igct, pValue_igct] = igct_alg(u,A,pf,igct_signif,flgPrintResults);
</pre><pre class="codeoutput">
----------------------------------------------------------------------
                         GRANGER CAUSALITY TEST
======================================================================

Connectivity matrix:
   NaN     0     1     0     1     0     0
     1   NaN     0     0     0     0     0
     1     1   NaN     0     0     0     0
     0     0     1   NaN     1     0     0
     0     0     0     1   NaN     0     0
     0     0     0     0     1   NaN     0
     0     0     0     1     0     1   NaN

Granger causality test p-values:
       NaN    0.6364    0.0016    0.2037         0    0.8152    0.5705
         0       NaN    0.0781    0.4398    0.2650    0.3092    0.5667
         0         0       NaN    0.7667    0.1323    0.4069    0.7486
    0.9779    0.6814         0       NaN         0    0.4785    0.7703
    0.0949    0.0681    0.9801         0       NaN    0.1466    0.2944
    0.3207    0.6830    0.0474    0.1983    0.0027       NaN    0.4577
    0.7477    0.4955    0.0271    0.0047    0.9398         0       NaN


Elapsed time is 0.016566 seconds.


----------------------------------------------------------------------
                  INSTANTANEOUS GRANGER CAUSALITY TEST
======================================================================

Instantaneous connectivity matrix:
   NaN     0     0     0     0     0     0
     0   NaN     0     0     0     0     0
     0     0   NaN     0     0     0     0
     0     0     0   NaN     0     0     0
     0     0     0     0   NaN     0     0
     0     0     0     0     0   NaN     0
     0     0     0     0     0     0   NaN

Instantaneous Granger causality test p-values:
       NaN    0.9699    0.9226    0.5607    0.2755    0.4920    0.3604
    0.9699       NaN    0.3106    0.3205    0.7217    0.5988    0.8746
    0.9226    0.3106       NaN    0.2576    0.5079    0.2621    0.7797
    0.5607    0.3205    0.2576       NaN    0.2242    0.8160    0.9610
    0.2755    0.7217    0.5079    0.2242       NaN    0.6198    0.7020
    0.4920    0.5988    0.2621    0.8160    0.6198       NaN    0.8689
    0.3604    0.8746    0.7797    0.9610    0.7020    0.8689       NaN

&gt;&gt;&gt;&gt; Instantaneous Granger causality NOT detected.

</pre><h2 id="9">Information PDC estimation</h2><p>PDC analysis results are saved in <b>c</b> structure. See asymp_pdc.m or issue</p><pre class="language-matlab">&gt;&gt; help asymp_pdc
</pre><p>command for more detail.</p><pre class="codeinput">nFreqs = 128;

c = asymp_pdc(u,A,pf,nFreqs,metric,alpha); <span class="comment">% Estimate PDC and asymptotic statistics</span>
    c.Tragct = Tr_gct;
    c.pvaluesgct = pValue_gct;
</pre><p><img src="milano_ipdc_presentation_eq16638434991807348760.png" alt="$|_iPDC(\lambda)|^2$" style="width:1px;height:0px;"> Matrix Layout Plotting</p><pre class="codeinput">flgPrinting = [1 0 1 2 3 0 2]; <span class="comment">% overriding default setting</span>
flgScale = 1;
flgMax = <span class="string">'pdc'</span>;
flgSignifColor = 3;
flgColor = [0];

w_max=fs/2;

strTitle1 = [<span class="string">'Model I with feedback: '</span>];
strTitle2 = [<span class="string">'[N='</span> int2str(nSegLength) <span class="string">'pts; IP='</span> int2str(c.p)  <span class="string">' ]'</span>];
strTitle =[strTitle1 strTitle2];
strID = <span class="string">'Baccala &amp; Sameshima (2001) Example 3'</span>;

[hxlabel,hylabel] = xplot(strID,c,flgPrinting,fs,w_max,chLabels, <span class="keyword">...</span>
                                 flgColor,flgScale,flgMax,flgSignifColor);
xplot_title(alpha,metric,<span class="string">'pdc'</span>,strID)
</pre><img vspace="5" hspace="5" src="milano_ipdc_presentation_01.png" style="width:720px;height:480px;" alt=""> <p>PDC inference p-values</p><pre class="codeinput">flgPrinting  =   [1 1 1 2 3 0 0];
flgScale = 2;
[hxlabel hylabel] = xplot_pvalues(strID, c, <span class="keyword">...</span>
                                  flgPrinting,fs,w_max,chLabels,flgColor,flgScale);
xplot_title(alpha,metric,<span class="string">'p-value PDC'</span>,strTitle);
</pre><img vspace="5" hspace="5" src="milano_ipdc_presentation_02.png" style="width:720px;height:480px;" alt=""> <h2 id="12">iDTF estimation</h2><p>metric = 'info';</p><pre class="codeinput">d = asymp_dtf(u,A,pf,nFreqs,metric,alpha); <span class="comment">% Estimate PDC and asymptotic statistics</span>
    d.Tragct = Tr_gct;
    d.pvaluesgct = pValue_gct;
</pre><p><tt>iDTF</tt>^2 Matrix Layout Plotting</p><pre class="codeinput">flgPrinting = [1 0 1 1 0 0 2]; <span class="comment">% overriding default setting</span>
flgScale = 1;
flgMax = <span class="string">'TCI'</span>;
flgSignifColor = 3;
flgColor = [0];

w_max=fs/2;

strTitle1 = [<span class="string">'Model I with feedback: '</span>];
strTitle2 = [<span class="string">'[N='</span> int2str(nSegLength) <span class="string">'pts; IP='</span> int2str(c.p)  <span class="string">' ]'</span>];
strTitle =[strTitle1 strTitle2];

strID = <span class="string">'Baccala &amp; Sameshima (2001) Example 3'</span>;
[hxlabel,hylabel] = xplot(strID,d,flgPrinting,fs,w_max,chLabels, <span class="keyword">...</span>
                                 flgColor,flgScale,flgMax,flgSignifColor);

xplot_title(alpha,metric,<span class="string">'dtf'</span>,strTitle);
</pre><img vspace="5" hspace="5" src="milano_ipdc_presentation_03.png" style="width:720px;height:480px;" alt=""> <p><tt>iDTF</tt>^2 Matrix Layout Plotting with Fine y-axis scaling</p><pre class="codeinput">flgPrinting = [1 1 1 2 0 0 2]; <span class="comment">% overriding default setting</span>
flgScale = 2;
flgMax = <span class="string">'TCI'</span>;
flgSignifColor = 3;
flgColor = [1];

w_max=fs/2;

strTitle1 = [<span class="string">'Model I with feedback: '</span>];
strTitle2 = [<span class="string">'[N='</span> int2str(nSegLength) <span class="string">'pts; IP='</span> int2str(c.p)  <span class="string">' ]'</span>];
strTitle =[strTitle1 strTitle2];

strID = <span class="string">'Baccala &amp; Sameshima (2001) Example 3'</span>;
[hxlabel,hylabel] = xplot(strID,d,flgPrinting,fs,w_max,chLabels, <span class="keyword">...</span>
                                 flgColor,flgScale,flgMax,flgSignifColor);

xplot_title(alpha,metric,<span class="string">'dtf'</span>,strTitle);


<span class="comment">% End of example simulation.</span>
</pre><img vspace="5" hspace="5" src="milano_ipdc_presentation_04.png" style="width:720px;height:480px;" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Baccala & Sameshima (2001b) 7-dimension VAR[2] model with loop and feedback
%
% Description:
%
% Baccala & Sameshima. Overcoming the limitations of correlation analysis 
% for many simultaneously processed neural structures, Progress in Brain 
% Research, 130:33REPLACE_WITH_DASH_DASH47, 2001.
%
% <http://dx.doi.org/10.1016/S0079-6123(01)30004-3>
%
% See also:
%
% 
% # Koichi Sameshima, Daniel Y. Takahashi, Luiz A. Baccala. On the
% statistical performance of Granger-causal connectivity estimators. Brain
% Informatics (2015) 2:119?133.
%
% <http://dx.doi.org/10.1007/s40708-015-0015-1>
% 
% Example Model 1 - 7-dimension VAR[2] model with loop and feedback

%% Data sample generation

clear; clc; format compact; format short

nDiscard = 50000;          % discarded points at beginning of simulation
nSegLength  = 5000;        % number of analyzed samples points
N = nDiscard + nSegLength; % number of simulated points

u = fbaccala2001b_model1_feedback_milano( nSegLength, nDiscard );

[nSegLength,nChannels]=size(u);

%chLabels = []; % or 
chLabels = {'x_1';'x_2';'x_3';'x_4';'x_5';'x_6';'x_7'};

fs = 1;
%% Model Interaction diagram, model equation and expected results
%
% <<fig_baccala2001b_graph.png>>
%
% Figure 2a from Baccala & Sameshima. _Biol. Cybern._ *84*:463-474, 2001.

%% Equation Model I with feedback
%
% <<fig_baccala2001b_eq.png>>
%

%% iDTF and iPDC expected results
%
% <<fig_sameshima2005_fig2_iDTFiPDCresults.png>>
%

%% Data pre-processing: detrending and standardization options
%

flgDetrend = 1;     % Detrending the data set
flgStandardize = 0; % No standardization
[nChannels,nSegLength] =size(u);
if nChannels > nSegLength, 
   u = u.'; 
   [nChannels,nSegLength]=size(u);
end;
if flgDetrend,
   for i=1:nChannels, u(i,:)=detrend(u(i,:)); end;
   disp('Time series were detrended.');
end;
if flgStandardize,
   for i=1:nChannels, u(i,:)=u(i,:)/std(u(i,:)); end;
   disp('Time series were scale-standardized.');
end;

%% 
% MVAR model estimation

alpha = 0.01;

maxIP = 30;         % maximum model order to consider.
alg = 1;            % 1: Nutall-Strand MVAR estimation algorithm
criterion = 1;      % 1: AIC, Akaike Information Criteria

fprintf('\n')
disp('Running MVAR estimation routine.')

[IP,pf,A,pb,B,ef,eb,vaic,Vaicv] = mvar(u,maxIP,alg,criterion);

disp(['Number of channels = ' int2str(nChannels) ' with ' ...
    int2str(nSegLength) ' data points; MAR model order = ' int2str(IP) '.']);
   fprintf('\n')

%%
% Testing for adequacy of MAR model fitting through Portmanteau test

h = 20; % testing lag
MVARadequacy_signif = 0.05; % VAR model estimation adequacy significance
                            % level
aValueMVAR = 1 - MVARadequacy_signif; % Confidence value for the testing

flgPrintResults = 1;

[Pass,Portmanteau,st,ths] = mvarresidue(ef,nSegLength,IP,aValueMVAR,h,...
                                           flgPrintResults);

%%
% Granger causality test (GCT) and instantaneous GCT (iGCT)

gct_signif  = alpha;  % Granger causality test significance level
igct_signif = alpha;  % Instantaneous GCT significance level

metric = 'info'; % euc  = original PDC or DTF;
                 % diag = generalized PDC (gPDC) or DC;
                 % info = information PDC (iPDC) or iDTF.
flgPrintResults = 1;

[Tr_gct, pValue_gct] = gct_alg2(u,A,pf,gct_signif,flgPrintResults);
[Tr_igct, pValue_igct] = igct_alg(u,A,pf,igct_signif,flgPrintResults);
                                                       
%% Information PDC estimation
%
% PDC analysis results are saved in *c* structure.
% See asymp_pdc.m or issue 
%
%   >> help asymp_pdc 
%
% command for more detail.
nFreqs = 128;

c = asymp_pdc(u,A,pf,nFreqs,metric,alpha); % Estimate PDC and asymptotic statistics
    c.Tragct = Tr_gct;
    c.pvaluesgct = pValue_gct;

%%
%
% $|_iPDC(\lambda)|^2$ Matrix Layout Plotting
%

flgPrinting = [1 0 1 2 3 0 2]; % overriding default setting
flgScale = 1;
flgMax = 'pdc';
flgSignifColor = 3;
flgColor = [0];

w_max=fs/2;

strTitle1 = ['Model I with feedback: '];
strTitle2 = ['[N=' int2str(nSegLength) 'pts; IP=' int2str(c.p)  ' ]'];
strTitle =[strTitle1 strTitle2];
strID = 'Baccala & Sameshima (2001) Example 3';

[hxlabel,hylabel] = xplot(strID,c,flgPrinting,fs,w_max,chLabels, ...
                                 flgColor,flgScale,flgMax,flgSignifColor);
xplot_title(alpha,metric,'pdc',strID)

%%
%
% PDC inference p-values

flgPrinting  =   [1 1 1 2 3 0 0];
flgScale = 2;
[hxlabel hylabel] = xplot_pvalues(strID, c, ...
                                  flgPrinting,fs,w_max,chLabels,flgColor,flgScale);
xplot_title(alpha,metric,'p-value PDC',strTitle);

%% iDTF estimation
%
% metric = 'info';
% 

d = asymp_dtf(u,A,pf,nFreqs,metric,alpha); % Estimate PDC and asymptotic statistics
    d.Tragct = Tr_gct;
    d.pvaluesgct = pValue_gct;
%%
%
% |iDTF|^2 Matrix Layout Plotting
%

flgPrinting = [1 0 1 1 0 0 2]; % overriding default setting
flgScale = 1;
flgMax = 'TCI';
flgSignifColor = 3;
flgColor = [0];

w_max=fs/2;

strTitle1 = ['Model I with feedback: '];
strTitle2 = ['[N=' int2str(nSegLength) 'pts; IP=' int2str(c.p)  ' ]'];
strTitle =[strTitle1 strTitle2];

strID = 'Baccala & Sameshima (2001) Example 3';
[hxlabel,hylabel] = xplot(strID,d,flgPrinting,fs,w_max,chLabels, ...
                                 flgColor,flgScale,flgMax,flgSignifColor);

xplot_title(alpha,metric,'dtf',strTitle);

%%
%%
%
% |iDTF|^2 Matrix Layout Plotting with Fine y-axis scaling
%

flgPrinting = [1 1 1 2 0 0 2]; % overriding default setting
flgScale = 2;
flgMax = 'TCI';
flgSignifColor = 3;
flgColor = [1];

w_max=fs/2;

strTitle1 = ['Model I with feedback: '];
strTitle2 = ['[N=' int2str(nSegLength) 'pts; IP=' int2str(c.p)  ' ]'];
strTitle =[strTitle1 strTitle2];

strID = 'Baccala & Sameshima (2001) Example 3';
[hxlabel,hylabel] = xplot(strID,d,flgPrinting,fs,w_max,chLabels, ...
                                 flgColor,flgScale,flgMax,flgSignifColor);

xplot_title(alpha,metric,'dtf',strTitle);


% End of example simulation.

##### SOURCE END #####
--></body></html>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>WINTERHALDER ET AL. (2005) 7-DIMENSION UNBALANCED RANDOM INDEPENDENT VARIABLES</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-07-26"><meta name="DC.source" content="winterhalder2005_variant.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>WINTERHALDER ET AL. (2005) 7-DIMENSION UNBALANCED RANDOM INDEPENDENT VARIABLES</h1><!--introduction--><p>Description:</p><p>Expanded to seven variables and modified to consider unbalanced variances example taken from:  Winterhalder et al. Comparison of linear signal processing techniques to  infer directed interactions in multivariate neural systems.  <i>Signal Processing</i> 85:2137--2160, 2005.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Data sample generation</a></li><li><a href="#3">Data generation function:</a></li><li><a href="#4">PDC/DTF  estimation and analysis parameters</a></li><li><a href="#5">Data pre-processing: detrending and standardization options</a></li><li><a href="#6">MVAR model estimation</a></li><li><a href="#7">Testing the adequacy of MAR model fitting through Portmanteau test</a></li><li><a href="#8">Granger causality test (GCT) and instantaneous GCT</a></li><li><a href="#9">PDC, threshold and confidence interval calculations.</a></li><li><a href="#11">Plotting options set up, mostly cosmetic for xplot.m routine:</a></li><li><a href="#13">Remarks on nonstandardized unbalanced noise analysis:</a></li><li><a href="#14">Information DTF estimation and analysis parameters</a></li><li><a href="#16">Remarks on false-positive connectivity detection ratio:</a></li></ul></div><p><a href="http://dx.doi.org/10.1016/j.sigpro.2005.07.011">http://dx.doi.org/10.1016/j.sigpro.2005.07.011</a></p><p>Example: Seven random independent variables with unbalanced variances. Variant of Random Independent Process with 7 variables') with following variances:</p><p><img src="winterhalder2005_variant_eq07584489195343151379.png" alt="$\sigma_1^2=\sigma_3^2=250000; \sigma_2^2=\sigma_4^2=\sigma_5^2=\sigma_6^2=\sigma_7^2=1$"></p><h2 id="2">Data sample generation</h2><pre class="codeinput">clear; clc; format <span class="string">compact</span>; format <span class="string">short</span>

flgPrintScreen = <span class="string">'Screen'</span>; <span class="comment">%'Screen' or  'Print'</span>

nDiscard = 1000;    <span class="comment">% number of points discarded at beginning of simulation</span>
nPoints  = 5000;    <span class="comment">% number of analyzed samples points</span>

alpha  = 0.05;  <span class="comment">% Significance level for PDC/DTF null hypothesis test</span>
</pre><h2 id="3">Data generation function:</h2><pre class="codeinput">u = fwinterhalder2005_variant(nPoints, nDiscard);

chLabels = {<span class="string">'x_1'</span>;<span class="string">'x_2'</span>;<span class="string">'x_3'</span>;<span class="string">'x_4'</span>;<span class="string">'x_5'</span>;<span class="string">'x_6'</span>;<span class="string">'x_7'</span>};<span class="comment">%chLabels = [];</span>
fs = 1; <span class="comment">% Normalized sampling frequency</span>
</pre><pre class="codeoutput">======================================================================
       Winterhalder et al. Signal Processing. 85:2137--60, 2005
        Variant of Random Independent Process with 7 variables
 [sigma1=500|sigma2=1|sigma3=500|sigma4=1|sigma5=1|sigma6=1|sigma7=1]
======================================================================
</pre><h2 id="4">PDC/DTF  estimation and analysis parameters</h2><pre class="codeinput"><span class="comment">% Common routine segment for all examples</span>
</pre><h2 id="5">Data pre-processing: detrending and standardization options</h2><pre class="codeinput">flgDetrend = 1;     <span class="comment">% 1: Detrending the data set</span>
flgStandardize = 0; <span class="comment">% 0: No standardization</span>

<span class="comment">% Checking data dimension</span>
[nChannels,nSegLength] = size(u);
<span class="keyword">if</span> nChannels &gt; nSegLength,
   u = u.';
   [nChannels,nSegLength] = size(u);
<span class="keyword">end</span>;

<span class="comment">% Detrending</span>
<span class="keyword">if</span> flgDetrend,
   <span class="keyword">for</span> i = 1:nChannels, u(i,:) = detrend(u(i,:)); <span class="keyword">end</span>;
   disp(<span class="string">'Time series were detrended.'</span>);
<span class="keyword">end</span>;

<span class="comment">% Standardization</span>
<span class="keyword">if</span> flgStandardize,
   <span class="keyword">for</span> i = 1:nChannels, u(i,:) = u(i,:)/std(u(i,:)); <span class="keyword">end</span>;
   disp(<span class="string">'Time series were scale-standardized.'</span>);
<span class="keyword">end</span>;
</pre><pre class="codeoutput">Time series were detrended.
</pre><h2 id="6">MVAR model estimation</h2><pre class="codeinput">maxIP = 30;         <span class="comment">% maximum model order to consider.</span>
alg = 1;            <span class="comment">% 1 = Nutall-Strand MVAR estimation algorithm</span>
criterion = 1;      <span class="comment">% 1 = AIC, Akaike Information Criteria</span>

disp(<span class="string">'Running MVAR estimation and GCT analysis routines.'</span>)

[IP,pf,A,pb,B,ef,eb,vaic,Vaicv] = mvar(u,maxIP,alg,criterion);

disp([<span class="string">'Number of channels = '</span> int2str(nChannels) <span class="string">' with '</span> <span class="keyword">...</span>
    int2str(nSegLength) <span class="string">' data points; MAR model order = '</span> int2str(IP) <span class="string">'.'</span>]);
</pre><pre class="codeoutput">Running MVAR estimation and GCT analysis routines.
maxOrder limited to 30
IP=1  vaic=422617.176616
IP=2  vaic=422649.396902
 
Number of channels = 7 with 5000 data points; MAR model order = 1.
</pre><h2 id="7">Testing the adequacy of MAR model fitting through Portmanteau test</h2><pre class="codeinput">h = 20; <span class="comment">% testing lag value</span>
MVARadequacy_signif = 0.05; <span class="comment">% VAR model estimation adequacy significance</span>
                            <span class="comment">% level</span>
aValueMVAR = 1 - MVARadequacy_signif; <span class="comment">% Confidence value for the testing</span>

flgPrintResults = 1; <span class="comment">% flag = 1, print analysis results</span>

[Pass,Portmanteau,st,ths] = mvarresidue(ef,nSegLength,IP,aValueMVAR,h,<span class="keyword">...</span>
                                           flgPrintResults);
</pre><pre class="codeoutput">
====================================================================================================
                  MVAR RESIDURES TEST FOR WHITENESS
----------------------------------------------------------------------------------------------------
Good MAR model fitting! Residues white noise hypothesis NOT rejected.
Pass = 0.0367347
  st = 933.968
</pre><h2 id="8">Granger causality test (GCT) and instantaneous GCT</h2><pre class="codeinput">gct_signif  = alpha;  <span class="comment">% Granger causality test significance level</span>
igct_signif = alpha;  <span class="comment">% Instantaneous GCT significance level</span>

metric = <span class="string">'diag'</span>; <span class="comment">% euc  = original PDC or DTF;</span>
                 <span class="comment">% diag = generalized PDC (gPDC) or DC;</span>
                 <span class="comment">% info = information PDC (iPDC) or iDTF.</span>

flgPrintResults = 1; <span class="comment">% Flag to control printing gct_alg.m results on command window.</span>

[Tr_gct, pValue_gct] = gct_alg(u,A,pf,gct_signif,flgPrintResults);
[Tr_igct, pValue_igct] = igct_alg(u,A,pf,igct_signif,flgPrintResults);
</pre><pre class="codeoutput">
====================================================================================================
                         GRANGER CAUSALITY TEST
----------------------------------------------------------------------------------------------------
Connectivity matrix:
   NaN     0     0     0     0     0     0
     0   NaN     0     0     0     0     0
     0     0   NaN     0     0     0     1
     0     0     0   NaN     0     1     0
     0     1     0     0   NaN     0     0
     0     0     0     0     0   NaN     0
     0     0     0     0     0     0   NaN

Granger causality test p-values:
       NaN    0.8666    0.1988    0.9753    0.2789    0.1655    0.3122
    0.6227       NaN    0.6688    0.1404    0.7020    0.5486    0.7910
    0.9713    0.7437       NaN    0.5379    0.8566    0.5638    0.0265
    0.2671    0.5431    0.2591       NaN    0.9457    0.0449    0.4402
    0.2514    0.0292    0.2652    0.3301       NaN    0.6886    0.2404
    0.8069    0.8272    0.6242    0.9621    0.0660       NaN    0.1708
    0.9621    0.7787    0.9411    0.5651    0.9584    0.2493       NaN

====================================================================================================
                  INSTANTANEOUS GRANGER CAUSALITY TEST
----------------------------------------------------------------------------------------------------
Instantaneous connectivity matrix:
   NaN     0     0     0     0     0     1
     0   NaN     0     0     0     0     0
     0     0   NaN     0     0     0     0
     0     0     0   NaN     0     0     0
     0     0     0     0   NaN     0     0
     0     0     0     0     0   NaN     0
     1     0     0     0     0     0   NaN

Instantaneous Granger Causality test p-values:
       NaN    0.0544    0.9224    0.1141    0.3855    0.7155    0.0205
    0.0544       NaN    0.9215    0.7536    0.2873    0.9987    0.2160
    0.9224    0.9215       NaN    0.8713    0.4462    0.1005    0.3323
    0.1141    0.7536    0.8713       NaN    0.6049    0.8625    0.2664
    0.3855    0.2873    0.4462    0.6049       NaN    0.8139    0.9833
    0.7155    0.9987    0.1005    0.8625    0.8139       NaN    0.3075
    0.0205    0.2160    0.3323    0.2664    0.9833    0.3075       NaN

&gt;&gt;&gt;&gt; There is a pair of channels with significant Instantaneous 
     Granger Causality.

====================================================================================================
</pre><h2 id="9">PDC, threshold and confidence interval calculations.</h2><pre class="codeinput">metric = <span class="string">'euc'</span>; <span class="comment">% Original DTF estimation</span>
nFreqs = 128;   <span class="comment">% Number of frequency points to consider</span>
</pre><p>PDC analysis results are saved in <b>c</b> data structure. See asymp_dtf.m or issue</p><pre class="language-matlab">&gt;&gt; help asymp_pdc
</pre><p>command for more detail.</p><pre class="codeinput">c = asymp_pdc(u,A,pf,nFreqs,metric,alpha);
    c.Tragct = Tr_gct;
    c.pvaluesgct = pValue_gct;
</pre><h2 id="11">Plotting options set up, mostly cosmetic for xplot.m routine:</h2><pre class="codeinput">flgMax = <span class="string">'all'</span>;
flgSignifColor = 4; <span class="comment">% red + green</span>
flgScale = 3;       <span class="comment">% [0 1]/[0 .1]/[0 .01]</span>
</pre><p>flgColor parameter for PDC matrix-layout plot.</p><pre class="codeinput">flgColor = [0];   <span class="comment">% Plotting option for automatic scaling for small PDC</span>
                  <span class="comment">% values.</span>
                  <span class="comment">% if flgColor = 0, y-axis scale = [0 1]</span>
                  <span class="comment">% elseif flgColor = 1, xplot routine rescale</span>
                  <span class="comment">% the y-axis automatically according to following rules:</span>
                  <span class="comment">%   If .001&lt;= max(|PDC(f)|^2) &lt; .01 background-color = light-blue,</span>
                  <span class="comment">%                          so that y-axis scale = [0 .1]</span>
                  <span class="comment">%   elseif max(|PDC(f)|^2) &lt; .001 background-color = light-purple</span>
                  <span class="comment">%                          and y-axis = [0 .01].</span>

<span class="comment">%                [1 2 3 4 5 6 7]</span>
flgPrinting  =   [1 0 1 0 0 0 0];
<span class="comment">%       blue-line | | | | | | 7--Spectra (0: w/o; 1: Linear; 2: Log; 3: PDC2;</span>
<span class="comment">%                 | | | | | |      4: Linear normalized; 5: Log spectra + PDC2)</span>
<span class="comment">%            gray | | | | | 6--Coh2 (0: w/o Coh2; 1: w Coh2)</span>
<span class="comment">%     dashed-blue | | | | 5--Print GCT results</span>
<span class="comment">%     dashed-blue | | | 4--Plot confidence interval</span>
<span class="comment">%            red  | | 3--Significant PDC2|DTF2 in red lines</span>
<span class="comment">%    dashed-black | 2--Patnaik threshold level in black dashed-lines</span>
<span class="comment">%           green 1-- PDC2/DTF2 in green lines or black w/o statistics,</span>
<span class="comment">%                     See flgSignifColor bellow for line color selection.</span>

w_max=fs/2;
strID = <span class="string">'Winterhalder et al. Signal Processing 85:2137?60, 2005'</span>;
strTitle = [<span class="string">' Independent Gaussian Noise: \sigma_1=\sigma_3=500;'</span> <span class="keyword">...</span>
                           <span class="string">' \sigma_2 = \sigma_4 = \sigma_5 = 1'</span>];

flgScale = 1;

[h,hxlabel hylabel] = xplot(strID, c, <span class="keyword">...</span>
                               flgPrinting,fs,w_max,chLabels,flgColor,flgScale,flgMax,flgSignifColor);
xplot_title(alpha,metric,<span class="string">'PDC'</span>,strTitle);

flgPrinting  =   [1 1 1 2 3 0 0];
[hp,hxlabel hylabel] = xplot_pvalues(strID, c, <span class="keyword">...</span>
                               flgPrinting,fs,w_max,chLabels,flgColor,flgScale);
xplot_title(alpha,metric,<span class="string">'p-value PDC'</span>,strTitle);
</pre><img vspace="5" hspace="5" src="winterhalder2005_variant_01.png" alt=""> <img vspace="5" hspace="5" src="winterhalder2005_variant_02.png" alt=""> <h2 id="13">Remarks on nonstandardized unbalanced noise analysis:</h2><div><ul><li>Note that in this example the time series were not standardized.</li><li>As a consequence, due to the high variance/power of channels   <img src="winterhalder2005_variant_eq07862914750616374602.png" alt="$X_1$"> and <img src="winterhalder2005_variant_eq14630334771696414491.png" alt="$X_3$">, <img src="winterhalder2005_variant_eq04653255622943413630.png" alt="$|PDC(\lambda)|^2$"> from other channels reaching these channels are   high, but   still in most cases not significant (represented by green lines).</li><li>The Patnaik thresholds plotted in dashed-lines may not be visible in these   subplots because their values are well above  upper limit of scale   range which is limited to [0 1] on y-axis.</li></ul></div><h2 id="14">Information DTF estimation and analysis parameters</h2><p>If the metric is either 'diag' or 'info', the unbalanced noises are ruled out or scaled in their formulation as you can see in the information DTF calculation results shown bellow. Same consideration would apply for information PDC.</p><p>PDC analysis results are saved in <b>d</b> structure. See asymp_dtf.m or issue</p><pre class="language-matlab">&gt;&gt; help asymp_dtf
</pre><p>for more detail.</p><p>When <b>flgColor=1</b> parameter option is used in the xplot.m routine, the y-axis intervals: (a) [0 .01] background is colored in <b>LIGHT-PURPLE</b>; (b) (.01 .1] in <b>LIGHT-BLUE</b>; and (c) (.1 1] is <b>WHITE</b>. If the y-axis is scaled according to the maximum amplitude of the measures, this color coding may help easily getting clue about the magnitude <img src="winterhalder2005_variant_eq15465123740211846091.png" alt="$|DTF|^2$"> or <img src="winterhalder2005_variant_eq06563705797252587072.png" alt="$|PDC|^2$"> estimates.</p><p>If the background is <b>LIGHT-PURPLE</b>  one would know the maximum amplitude is smaller than 1/100, while with <b>LIGHT-BLUE</b> background is smaller than 1/10.</p><h2 id="16">Remarks on false-positive connectivity detection ratio:</h2><div><ul><li>As 42 combinations of DTF/GC are tested, chances are that you     will see significant <img src="winterhalder2005_variant_eq07741536688981312772.png" alt="$|DTF(\lambda)|^2$"> (red lines), also in the case of     <img src="winterhalder2005_variant_eq04653255622943413630.png" alt="$|PDC(\lambda)|^2$"> (see above), in some plottings. The     significant DTF probability depends on significance level you     choose for null hypothesis DTF testing.</li><li>The false-positive rate is approximately equal to the chosen <img src="winterhalder2005_variant_eq14221827199139923399.png" alt="$\alpha$"> value.</li><li>The similar argument applies to "instantaneous Granger causality"     outcomes, and combination of 21 pairs of variables are considered     as iGC is a symmetric relation.</li></ul></div><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% WINTERHALDER ET AL. (2005) 7-DIMENSION UNBALANCED RANDOM INDEPENDENT VARIABLES
% Description:
%
% Expanded to seven variables and modified to consider unbalanced variances example taken from:
%  Winterhalder et al. Comparison of linear signal processing techniques to
%  infer directed interactions in multivariate neural systems. 
%  _Signal Processing_ 85:2137REPLACE_WITH_DASH_DASH2160, 2005.
%
%%
%
% <http://dx.doi.org/10.1016/j.sigpro.2005.07.011>
%
% Example: Seven random independent variables with unbalanced variances.
% Variant of Random Independent Process with 7 variables') with following
% variances:
%
% $\sigma_1^2=\sigma_3^2=250000; \sigma_2^2=\sigma_4^2=\sigma_5^2=\sigma_6^2=\sigma_7^2=1$

%% Data sample generation

clear; clc; format compact; format short

flgPrintScreen = 'Screen'; %'Screen' or  'Print'

nDiscard = 1000;    % number of points discarded at beginning of simulation
nPoints  = 5000;    % number of analyzed samples points

alpha  = 0.05;  % Significance level for PDC/DTF null hypothesis test

%% Data generation function:
u = fwinterhalder2005_variant(nPoints, nDiscard);

chLabels = {'x_1';'x_2';'x_3';'x_4';'x_5';'x_6';'x_7'};%chLabels = [];
fs = 1; % Normalized sampling frequency 

%% PDC/DTF  estimation and analysis parameters

% Common routine segment for all examples

%% Data pre-processing: detrending and standardization options

flgDetrend = 1;     % 1: Detrending the data set
flgStandardize = 0; % 0: No standardization

% Checking data dimension
[nChannels,nSegLength] = size(u);
if nChannels > nSegLength, 
   u = u.'; 
   [nChannels,nSegLength] = size(u);
end;

% Detrending 
if flgDetrend,
   for i = 1:nChannels, u(i,:) = detrend(u(i,:)); end;
   disp('Time series were detrended.');
end;

% Standardization 
if flgStandardize,
   for i = 1:nChannels, u(i,:) = u(i,:)/std(u(i,:)); end;
   disp('Time series were scale-standardized.');
end;

%% MVAR model estimation

maxIP = 30;         % maximum model order to consider.
alg = 1;            % 1 = Nutall-Strand MVAR estimation algorithm
criterion = 1;      % 1 = AIC, Akaike Information Criteria

disp('Running MVAR estimation and GCT analysis routines.')

[IP,pf,A,pb,B,ef,eb,vaic,Vaicv] = mvar(u,maxIP,alg,criterion);

disp(['Number of channels = ' int2str(nChannels) ' with ' ...
    int2str(nSegLength) ' data points; MAR model order = ' int2str(IP) '.']);

%% Testing the adequacy of MAR model fitting through Portmanteau test

h = 20; % testing lag value
MVARadequacy_signif = 0.05; % VAR model estimation adequacy significance
                            % level
aValueMVAR = 1 - MVARadequacy_signif; % Confidence value for the testing

flgPrintResults = 1; % flag = 1, print analysis results

[Pass,Portmanteau,st,ths] = mvarresidue(ef,nSegLength,IP,aValueMVAR,h,...
                                           flgPrintResults);

%% Granger causality test (GCT) and instantaneous GCT

gct_signif  = alpha;  % Granger causality test significance level
igct_signif = alpha;  % Instantaneous GCT significance level

metric = 'diag'; % euc  = original PDC or DTF;
                 % diag = generalized PDC (gPDC) or DC;
                 % info = information PDC (iPDC) or iDTF.
                 
flgPrintResults = 1; % Flag to control printing gct_alg.m results on command window.

[Tr_gct, pValue_gct] = gct_alg(u,A,pf,gct_signif,flgPrintResults);
[Tr_igct, pValue_igct] = igct_alg(u,A,pf,igct_signif,flgPrintResults);
                                                       
%% PDC, threshold and confidence interval calculations.
%
metric = 'euc'; % Original DTF estimation
nFreqs = 128;   % Number of frequency points to consider

%%
% PDC analysis results are saved in *c* data structure.
% See asymp_dtf.m or issue 
%
%   >> help asymp_pdc 
%
% command for more detail.

c = asymp_pdc(u,A,pf,nFreqs,metric,alpha);
    c.Tragct = Tr_gct;
    c.pvaluesgct = pValue_gct;

    
%% Plotting options set up, mostly cosmetic for xplot.m routine:
%

flgMax = 'all';
flgSignifColor = 4; % red + green
flgScale = 3;       % [0 1]/[0 .1]/[0 .01]

%%
% flgColor parameter for PDC matrix-layout plot.
flgColor = [0];   % Plotting option for automatic scaling for small PDC
                  % values.
                  % if flgColor = 0, y-axis scale = [0 1]
                  % elseif flgColor = 1, xplot routine rescale 
                  % the y-axis automatically according to following rules:
                  %   If .001<= max(|PDC(f)|^2) < .01 background-color = light-blue,
                  %                          so that y-axis scale = [0 .1]
                  %   elseif max(|PDC(f)|^2) < .001 background-color = light-purple
                  %                          and y-axis = [0 .01].

%                [1 2 3 4 5 6 7]
flgPrinting  =   [1 0 1 0 0 0 0];
%       blue-line | | | | | | 7REPLACE_WITH_DASH_DASHSpectra (0: w/o; 1: Linear; 2: Log; 3: PDC2; 
%                 | | | | | |      4: Linear normalized; 5: Log spectra + PDC2)
%            gray | | | | | 6REPLACE_WITH_DASH_DASHCoh2 (0: w/o Coh2; 1: w Coh2)
%     dashed-blue | | | | 5REPLACE_WITH_DASH_DASHPrint GCT results
%     dashed-blue | | | 4REPLACE_WITH_DASH_DASHPlot confidence interval
%            red  | | 3REPLACE_WITH_DASH_DASHSignificant PDC2|DTF2 in red lines
%    dashed-black | 2REPLACE_WITH_DASH_DASHPatnaik threshold level in black dashed-lines
%           green 1REPLACE_WITH_DASH_DASH PDC2/DTF2 in green lines or black w/o statistics,
%                     See flgSignifColor bellow for line color selection.

w_max=fs/2;
strID = 'Winterhalder et al. Signal Processing 85:2137?60, 2005';
strTitle = [' Independent Gaussian Noise: \sigma_1=\sigma_3=500;' ...
                           ' \sigma_2 = \sigma_4 = \sigma_5 = 1'];

flgScale = 1;

[h,hxlabel hylabel] = xplot(strID, c, ...
                               flgPrinting,fs,w_max,chLabels,flgColor,flgScale,flgMax,flgSignifColor);
xplot_title(alpha,metric,'PDC',strTitle);

flgPrinting  =   [1 1 1 2 3 0 0];
[hp,hxlabel hylabel] = xplot_pvalues(strID, c, ...
                               flgPrinting,fs,w_max,chLabels,flgColor,flgScale);
xplot_title(alpha,metric,'p-value PDC',strTitle);


%% Remarks on nonstandardized unbalanced noise analysis:
% 
% * Note that in this example the time series were not standardized.
% * As a consequence, due to the high variance/power of channels
%   $X_1$ and $X_3$, $|PDC(\lambda)|^2$ from other channels reaching these channels are 
%   high, but
%   still in most cases not significant (represented by green lines).
% * The Patnaik thresholds plotted in dashed-lines may not be visible in these 
%   subplots because their values are well above  upper limit of scale 
%   range which is limited to [0 1] on y-axis.
%   

%% Information DTF estimation and analysis parameters
% 
% If the metric is either 'diag' or 'info', the unbalanced noises are 
% ruled out or scaled in their formulation as you can see in 
% the information DTF calculation results shown
% bellow. Same consideration would apply for information PDC.
%
% PDC analysis results are saved in *d* structure.
% See asymp_dtf.m or issue 
%
%   >> help asymp_dtf 
%
% for more detail.


%%
% When *flgColor=1* parameter option is used in the xplot.m routine, the
% y-axis intervals: (a) [0 .01] background is colored in *LIGHT-PURPLE*; (b) (.01 .1] in
% *LIGHT-BLUE*; and (c) (.1 1] is *WHITE*.
% If the y-axis is scaled according to the maximum amplitude of the measures, 
% this color coding may help easily getting clue about the magnitude 
% $|DTF|^2$ or $|PDC|^2$ estimates.
%
% If the background is *LIGHT-PURPLE*  one would know the maximum amplitude is
% smaller than 1/100, while with *LIGHT-BLUE* background is smaller than 1/10.

%% Remarks on false-positive connectivity detection ratio:
% 
% * As 42 combinations of DTF/GC are tested, chances are that you
%     will see significant $|DTF(\lambda)|^2$ (red lines), also in the case of 
%     $|PDC(\lambda)|^2$ (see above), in some plottings. The 
%     significant DTF probability depends on significance level you 
%     choose for null hypothesis DTF testing.
% * The false-positive rate is approximately equal to the chosen $\alpha$ value.
% * The similar argument applies to "instantaneous Granger causality"
%     outcomes, and combination of 21 pairs of variables are considered
%     as iGC is a symmetric relation.
%

##### SOURCE END #####
--></body></html>